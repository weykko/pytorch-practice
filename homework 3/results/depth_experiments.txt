1.1: Сравнение моделей разной глубины

Обучение модели 1_layer
100%|██████████| 938/938 [00:23<00:00, 39.52it/s]
100%|██████████| 157/157 [00:03<00:00, 44.19it/s]
  0%|          | 0/938 [00:00<?, ?it/s]Epoch 1/10:
Train Loss: 0.3876, Train Acc: 0.8901
Test Loss: 0.2963, Test Acc: 0.9135
--------------------------------------------------
100%|██████████| 938/938 [00:21<00:00, 44.06it/s]
100%|██████████| 157/157 [00:03<00:00, 44.72it/s]
  0%|          | 0/938 [00:00<?, ?it/s]Epoch 2/10:
Train Loss: 0.2939, Train Acc: 0.9168
Test Loss: 0.2799, Test Acc: 0.9190
--------------------------------------------------
100%|██████████| 938/938 [00:21<00:00, 43.88it/s]
100%|██████████| 157/157 [00:03<00:00, 45.70it/s]
Epoch 3/10:
Train Loss: 0.2817, Train Acc: 0.9209
Test Loss: 0.2783, Test Acc: 0.9210
--------------------------------------------------
100%|██████████| 938/938 [00:21<00:00, 43.67it/s]
100%|██████████| 157/157 [00:03<00:00, 45.47it/s]
  0%|          | 0/938 [00:00<?, ?it/s]Epoch 4/10:
Train Loss: 0.2746, Train Acc: 0.9230
Test Loss: 0.2747, Test Acc: 0.9211
--------------------------------------------------
100%|██████████| 938/938 [00:21<00:00, 43.95it/s]
100%|██████████| 157/157 [00:03<00:00, 43.06it/s]
  0%|          | 0/938 [00:00<?, ?it/s]Epoch 5/10:
Train Loss: 0.2707, Train Acc: 0.9239
Test Loss: 0.2718, Test Acc: 0.9223
--------------------------------------------------
100%|██████████| 938/938 [00:21<00:00, 43.53it/s]
100%|██████████| 157/157 [00:03<00:00, 44.90it/s]
Epoch 6/10:
Train Loss: 0.2679, Train Acc: 0.9251
Test Loss: 0.2710, Test Acc: 0.9240
--------------------------------------------------
100%|██████████| 938/938 [00:22<00:00, 41.50it/s]
100%|██████████| 157/157 [00:03<00:00, 44.43it/s]
  0%|          | 0/938 [00:00<?, ?it/s]Epoch 7/10:
Train Loss: 0.2652, Train Acc: 0.9260
Test Loss: 0.2749, Test Acc: 0.9231
--------------------------------------------------
100%|██████████| 938/938 [00:21<00:00, 44.07it/s]
100%|██████████| 157/157 [00:03<00:00, 44.56it/s]
  0%|          | 0/938 [00:00<?, ?it/s]Epoch 8/10:
Train Loss: 0.2627, Train Acc: 0.9274
Test Loss: 0.2710, Test Acc: 0.9244
--------------------------------------------------
100%|██████████| 938/938 [00:21<00:00, 43.35it/s]
100%|██████████| 157/157 [00:03<00:00, 44.22it/s]
  0%|          | 0/938 [00:00<?, ?it/s]Epoch 9/10:
Train Loss: 0.2608, Train Acc: 0.9265
Test Loss: 0.2707, Test Acc: 0.9248
--------------------------------------------------
100%|██████████| 938/938 [00:21<00:00, 43.78it/s]
100%|██████████| 157/157 [00:03<00:00, 46.05it/s]
Epoch 10/10:
Train Loss: 0.2608, Train Acc: 0.9274
Test Loss: 0.2812, Test Acc: 0.9214
--------------------------------------------------
1_layer - Время обучения: 252.84 секунд
1_layer - Итоговая точность на тестовом наборе: 0.9214
  0%|          | 0/938 [00:00<?, ?it/s]
Обучение модели 2_layers
100%|██████████| 938/938 [00:23<00:00, 40.78it/s]
100%|██████████| 157/157 [00:03<00:00, 44.79it/s]
  0%|          | 0/938 [00:00<?, ?it/s]Epoch 1/10:
Train Loss: 0.2285, Train Acc: 0.9325
Test Loss: 0.1117, Test Acc: 0.9659
--------------------------------------------------
100%|██████████| 938/938 [00:23<00:00, 40.27it/s]
100%|██████████| 157/157 [00:03<00:00, 44.56it/s]
  0%|          | 0/938 [00:00<?, ?it/s]Epoch 2/10:
Train Loss: 0.0959, Train Acc: 0.9701
Test Loss: 0.0942, Test Acc: 0.9703
--------------------------------------------------
100%|██████████| 938/938 [00:24<00:00, 38.57it/s]
100%|██████████| 157/157 [00:03<00:00, 44.81it/s]
  0%|          | 0/938 [00:00<?, ?it/s]Epoch 3/10:
Train Loss: 0.0656, Train Acc: 0.9792
Test Loss: 0.0867, Test Acc: 0.9735
--------------------------------------------------
100%|██████████| 938/938 [00:23<00:00, 39.91it/s]
100%|██████████| 157/157 [00:03<00:00, 43.28it/s]
  0%|          | 0/938 [00:00<?, ?it/s]Epoch 4/10:
Train Loss: 0.0478, Train Acc: 0.9849
Test Loss: 0.0711, Test Acc: 0.9786
--------------------------------------------------
100%|██████████| 938/938 [00:23<00:00, 40.18it/s]
100%|██████████| 157/157 [00:03<00:00, 44.70it/s]
Epoch 5/10:
Train Loss: 0.0358, Train Acc: 0.9886
Test Loss: 0.0775, Test Acc: 0.9781
--------------------------------------------------
100%|██████████| 938/938 [00:23<00:00, 40.50it/s]
100%|██████████| 157/157 [00:03<00:00, 44.43it/s]
  0%|          | 0/938 [00:00<?, ?it/s]Epoch 6/10:
Train Loss: 0.0309, Train Acc: 0.9901
Test Loss: 0.0738, Test Acc: 0.9778
--------------------------------------------------
100%|██████████| 938/938 [00:23<00:00, 39.89it/s]
100%|██████████| 157/157 [00:03<00:00, 44.84it/s]
Epoch 7/10:
Train Loss: 0.0249, Train Acc: 0.9917
Test Loss: 0.0852, Test Acc: 0.9761
--------------------------------------------------
100%|██████████| 938/938 [00:23<00:00, 39.77it/s]
100%|██████████| 157/157 [00:03<00:00, 44.49it/s]
Epoch 8/10:
Train Loss: 0.0218, Train Acc: 0.9924
Test Loss: 0.0770, Test Acc: 0.9795
--------------------------------------------------
100%|██████████| 938/938 [00:23<00:00, 40.32it/s]
100%|██████████| 157/157 [00:03<00:00, 44.19it/s]
Epoch 9/10:
Train Loss: 0.0181, Train Acc: 0.9937
Test Loss: 0.0906, Test Acc: 0.9783
--------------------------------------------------
100%|██████████| 938/938 [00:23<00:00, 40.58it/s]
100%|██████████| 157/157 [00:03<00:00, 44.04it/s]
Epoch 10/10:
Train Loss: 0.0177, Train Acc: 0.9940
Test Loss: 0.0949, Test Acc: 0.9778
--------------------------------------------------
2_layers - Время обучения: 269.45 секунд
2_layers - Итоговая точность на тестовом наборе: 0.9778

Обучение модели 3_layers
100%|██████████| 938/938 [00:23<00:00, 39.54it/s]
100%|██████████| 157/157 [00:03<00:00, 45.14it/s]
  0%|          | 0/938 [00:00<?, ?it/s]Epoch 1/10:
Train Loss: 0.2202, Train Acc: 0.9329
Test Loss: 0.1062, Test Acc: 0.9659
--------------------------------------------------
100%|██████████| 938/938 [00:23<00:00, 39.78it/s]
100%|██████████| 157/157 [00:03<00:00, 44.65it/s]
  0%|          | 0/938 [00:00<?, ?it/s]Epoch 2/10:
Train Loss: 0.0910, Train Acc: 0.9716
Test Loss: 0.0838, Test Acc: 0.9742
--------------------------------------------------
100%|██████████| 938/938 [00:23<00:00, 40.75it/s]
100%|██████████| 157/157 [00:03<00:00, 43.00it/s]
Epoch 3/10:
Train Loss: 0.0637, Train Acc: 0.9794
Test Loss: 0.0878, Test Acc: 0.9728
--------------------------------------------------
100%|██████████| 938/938 [00:23<00:00, 39.80it/s]
100%|██████████| 157/157 [00:03<00:00, 43.94it/s]
Epoch 4/10:
Train Loss: 0.0509, Train Acc: 0.9831
Test Loss: 0.0825, Test Acc: 0.9777
--------------------------------------------------
100%|██████████| 938/938 [00:23<00:00, 39.75it/s]
100%|██████████| 157/157 [00:03<00:00, 44.67it/s]
  0%|          | 0/938 [00:00<?, ?it/s]Epoch 5/10:
Train Loss: 0.0404, Train Acc: 0.9869
Test Loss: 0.0883, Test Acc: 0.9741
--------------------------------------------------
100%|██████████| 938/938 [00:23<00:00, 39.39it/s]
100%|██████████| 157/157 [00:03<00:00, 43.93it/s]
Epoch 6/10:
Train Loss: 0.0323, Train Acc: 0.9889
Test Loss: 0.0783, Test Acc: 0.9783
--------------------------------------------------
100%|██████████| 938/938 [00:23<00:00, 39.29it/s]
100%|██████████| 157/157 [00:03<00:00, 44.75it/s]
  0%|          | 0/938 [00:00<?, ?it/s]Epoch 7/10:
Train Loss: 0.0300, Train Acc: 0.9897
Test Loss: 0.0908, Test Acc: 0.9776
--------------------------------------------------
100%|██████████| 938/938 [00:23<00:00, 40.18it/s]
100%|██████████| 157/157 [00:03<00:00, 44.54it/s]
Epoch 8/10:
Train Loss: 0.0237, Train Acc: 0.9922
Test Loss: 0.0868, Test Acc: 0.9796
--------------------------------------------------
100%|██████████| 938/938 [00:23<00:00, 39.92it/s]
100%|██████████| 157/157 [00:03<00:00, 44.92it/s]
  0%|          | 0/938 [00:00<?, ?it/s]Epoch 9/10:
Train Loss: 0.0245, Train Acc: 0.9921
Test Loss: 0.1019, Test Acc: 0.9761
--------------------------------------------------
100%|██████████| 938/938 [00:23<00:00, 39.86it/s]
100%|██████████| 157/157 [00:03<00:00, 43.07it/s]
Epoch 10/10:
Train Loss: 0.0209, Train Acc: 0.9929
Test Loss: 0.0892, Test Acc: 0.9801
--------------------------------------------------
3_layers - Время обучения: 271.04 секунд
3_layers - Итоговая точность на тестовом наборе: 0.9801

Обучение модели 5_layers
100%|██████████| 938/938 [00:26<00:00, 36.04it/s]
100%|██████████| 157/157 [00:03<00:00, 43.81it/s]
  0%|          | 0/938 [00:00<?, ?it/s]Epoch 1/10:
Train Loss: 0.2524, Train Acc: 0.9218
Test Loss: 0.1199, Test Acc: 0.9653
--------------------------------------------------
100%|██████████| 938/938 [00:25<00:00, 37.11it/s]
100%|██████████| 157/157 [00:03<00:00, 44.14it/s]
  0%|          | 0/938 [00:00<?, ?it/s]Epoch 2/10:
Train Loss: 0.1074, Train Acc: 0.9679
Test Loss: 0.1229, Test Acc: 0.9639
--------------------------------------------------
100%|██████████| 938/938 [00:25<00:00, 37.41it/s]
100%|██████████| 157/157 [00:03<00:00, 42.09it/s]
  0%|          | 0/938 [00:00<?, ?it/s]Epoch 3/10:
Train Loss: 0.0795, Train Acc: 0.9761
Test Loss: 0.0703, Test Acc: 0.9783
--------------------------------------------------
100%|██████████| 938/938 [00:24<00:00, 38.30it/s]
100%|██████████| 157/157 [00:03<00:00, 42.14it/s]
Epoch 4/10:
Train Loss: 0.0622, Train Acc: 0.9815
Test Loss: 0.0770, Test Acc: 0.9770
--------------------------------------------------
100%|██████████| 938/938 [00:25<00:00, 36.56it/s]
100%|██████████| 157/157 [00:03<00:00, 43.45it/s]
  0%|          | 0/938 [00:00<?, ?it/s]Epoch 5/10:
Train Loss: 0.0541, Train Acc: 0.9837
Test Loss: 0.0876, Test Acc: 0.9780
--------------------------------------------------
100%|██████████| 938/938 [00:25<00:00, 36.88it/s]
100%|██████████| 157/157 [00:03<00:00, 42.18it/s]
Epoch 6/10:
Train Loss: 0.0472, Train Acc: 0.9859
Test Loss: 0.0778, Test Acc: 0.9781
--------------------------------------------------
100%|██████████| 938/938 [00:25<00:00, 36.50it/s]
100%|██████████| 157/157 [00:03<00:00, 42.01it/s]
  0%|          | 0/938 [00:00<?, ?it/s]Epoch 7/10:
Train Loss: 0.0386, Train Acc: 0.9882
Test Loss: 0.1023, Test Acc: 0.9727
--------------------------------------------------
100%|██████████| 938/938 [00:26<00:00, 35.91it/s]
100%|██████████| 157/157 [00:04<00:00, 37.34it/s]
Epoch 8/10:
Train Loss: 0.0335, Train Acc: 0.9895
Test Loss: 0.0789, Test Acc: 0.9803
--------------------------------------------------
100%|██████████| 938/938 [00:26<00:00, 34.93it/s]
100%|██████████| 157/157 [00:03<00:00, 42.94it/s]
Epoch 9/10:
Train Loss: 0.0298, Train Acc: 0.9912
Test Loss: 0.0782, Test Acc: 0.9812
--------------------------------------------------
100%|██████████| 938/938 [00:25<00:00, 37.01it/s]
100%|██████████| 157/157 [00:03<00:00, 40.70it/s]
Epoch 10/10:
Train Loss: 0.0304, Train Acc: 0.9907
Test Loss: 0.0805, Test Acc: 0.9788
--------------------------------------------------
5_layers - Время обучения: 293.36 секунд
5_layers - Итоговая точность на тестовом наборе: 0.9788

Обучение модели 7_layers
100%|██████████| 938/938 [00:28<00:00, 32.57it/s]
100%|██████████| 157/157 [00:03<00:00, 43.23it/s]
  0%|          | 0/938 [00:00<?, ?it/s]Epoch 1/10:
Train Loss: 0.2974, Train Acc: 0.9074
Test Loss: 0.1396, Test Acc: 0.9596
--------------------------------------------------
100%|██████████| 938/938 [00:28<00:00, 32.50it/s]
100%|██████████| 157/157 [00:04<00:00, 38.01it/s]
  0%|          | 0/938 [00:00<?, ?it/s]Epoch 2/10:
Train Loss: 0.1282, Train Acc: 0.9637
Test Loss: 0.1100, Test Acc: 0.9671
--------------------------------------------------
100%|██████████| 938/938 [00:28<00:00, 32.75it/s]
100%|██████████| 157/157 [00:03<00:00, 41.97it/s]
Epoch 3/10:
Train Loss: 0.0943, Train Acc: 0.9735
Test Loss: 0.1265, Test Acc: 0.9651
--------------------------------------------------
100%|██████████| 938/938 [00:26<00:00, 35.06it/s]
100%|██████████| 157/157 [00:03<00:00, 42.42it/s]
Epoch 4/10:
Train Loss: 0.0771, Train Acc: 0.9780
Test Loss: 0.1114, Test Acc: 0.9723
--------------------------------------------------
100%|██████████| 938/938 [00:27<00:00, 33.87it/s]
100%|██████████| 157/157 [00:03<00:00, 42.57it/s]
  0%|          | 0/938 [00:00<?, ?it/s]Epoch 5/10:
Train Loss: 0.0653, Train Acc: 0.9820
Test Loss: 0.0998, Test Acc: 0.9750
--------------------------------------------------
100%|██████████| 938/938 [00:26<00:00, 35.15it/s]
100%|██████████| 157/157 [00:03<00:00, 41.91it/s]
  0%|          | 0/938 [00:00<?, ?it/s]Epoch 6/10:
Train Loss: 0.0577, Train Acc: 0.9837
Test Loss: 0.1262, Test Acc: 0.9691
--------------------------------------------------
100%|██████████| 938/938 [00:25<00:00, 36.82it/s]
100%|██████████| 157/157 [00:03<00:00, 43.93it/s]
  0%|          | 0/938 [00:00<?, ?it/s]Epoch 7/10:
Train Loss: 0.0502, Train Acc: 0.9859
Test Loss: 0.0939, Test Acc: 0.9766
--------------------------------------------------
100%|██████████| 938/938 [00:25<00:00, 36.81it/s]
100%|██████████| 157/157 [00:03<00:00, 41.98it/s]
  0%|          | 0/938 [00:00<?, ?it/s]Epoch 8/10:
Train Loss: 0.0460, Train Acc: 0.9872
Test Loss: 0.0902, Test Acc: 0.9779
--------------------------------------------------
100%|██████████| 938/938 [00:27<00:00, 33.56it/s]
100%|██████████| 157/157 [00:03<00:00, 42.00it/s]
Epoch 9/10:
Train Loss: 0.0401, Train Acc: 0.9892
Test Loss: 0.1007, Test Acc: 0.9784
--------------------------------------------------
100%|██████████| 938/938 [00:26<00:00, 35.50it/s]
100%|██████████| 157/157 [00:03<00:00, 41.91it/s]
Epoch 10/10:
Train Loss: 0.0378, Train Acc: 0.9895
Test Loss: 0.1072, Test Acc: 0.9780
--------------------------------------------------
7_layers - Время обучения: 310.22 секунд
7_layers - Итоговая точность на тестовом наборе: 0.9780
  0%|          | 0/938 [00:00<?, ?it/s]
1.2: Анализ переобучения с регуляризацией

Обучение модели 2_layers_reg
100%|██████████| 938/938 [00:23<00:00, 39.48it/s]
100%|██████████| 157/157 [00:03<00:00, 42.49it/s]
Epoch 1/10:
Train Loss: 0.2509, Train Acc: 0.9295
Test Loss: 0.1167, Test Acc: 0.9670
--------------------------------------------------
100%|██████████| 938/938 [00:23<00:00, 39.29it/s]
100%|██████████| 157/157 [00:03<00:00, 41.28it/s]
  0%|          | 0/938 [00:00<?, ?it/s]Epoch 2/10:
Train Loss: 0.1239, Train Acc: 0.9635
Test Loss: 0.0925, Test Acc: 0.9719
--------------------------------------------------
100%|██████████| 938/938 [00:23<00:00, 40.19it/s]
100%|██████████| 157/157 [00:03<00:00, 44.21it/s]
Epoch 3/10:
Train Loss: 0.0963, Train Acc: 0.9704
Test Loss: 0.0876, Test Acc: 0.9734
--------------------------------------------------
100%|██████████| 938/938 [00:23<00:00, 39.59it/s]
100%|██████████| 157/157 [00:03<00:00, 43.81it/s]
  0%|          | 0/938 [00:00<?, ?it/s]Epoch 4/10:
Train Loss: 0.0779, Train Acc: 0.9762
Test Loss: 0.0759, Test Acc: 0.9752
--------------------------------------------------
100%|██████████| 938/938 [00:23<00:00, 40.37it/s]
100%|██████████| 157/157 [00:03<00:00, 42.52it/s]
Epoch 5/10:
Train Loss: 0.0655, Train Acc: 0.9798
Test Loss: 0.0670, Test Acc: 0.9786
--------------------------------------------------
100%|██████████| 938/938 [00:23<00:00, 39.43it/s]
100%|██████████| 157/157 [00:03<00:00, 44.23it/s]
  0%|          | 0/938 [00:00<?, ?it/s]Epoch 6/10:
Train Loss: 0.0583, Train Acc: 0.9812
Test Loss: 0.0683, Test Acc: 0.9791
--------------------------------------------------
100%|██████████| 938/938 [00:23<00:00, 39.27it/s]
100%|██████████| 157/157 [00:03<00:00, 42.57it/s]
  0%|          | 0/938 [00:00<?, ?it/s]Epoch 7/10:
Train Loss: 0.0509, Train Acc: 0.9841
Test Loss: 0.0642, Test Acc: 0.9805
--------------------------------------------------
100%|██████████| 938/938 [00:23<00:00, 39.79it/s]
100%|██████████| 157/157 [00:03<00:00, 44.49it/s]
Epoch 8/10:
Train Loss: 0.0465, Train Acc: 0.9848
Test Loss: 0.0649, Test Acc: 0.9800
--------------------------------------------------
100%|██████████| 938/938 [00:22<00:00, 41.07it/s]
100%|██████████| 157/157 [00:03<00:00, 44.65it/s]
Epoch 9/10:
Train Loss: 0.0421, Train Acc: 0.9867
Test Loss: 0.0638, Test Acc: 0.9791
--------------------------------------------------
100%|██████████| 938/938 [00:23<00:00, 40.17it/s]
100%|██████████| 157/157 [00:03<00:00, 44.30it/s]
Epoch 10/10:
Train Loss: 0.0376, Train Acc: 0.9880
Test Loss: 0.0633, Test Acc: 0.9789
--------------------------------------------------
2_layers_reg - Время обучения: 271.50 секунд
2_layers_reg - Итоговая точность на тестовом наборе: 0.9789
  0%|          | 0/938 [00:00<?, ?it/s]
Обучение модели 3_layers_reg
100%|██████████| 938/938 [00:24<00:00, 38.26it/s]
100%|██████████| 157/157 [00:03<00:00, 43.37it/s]
  0%|          | 0/938 [00:00<?, ?it/s]Epoch 1/10:
Train Loss: 0.2388, Train Acc: 0.9296
Test Loss: 0.0949, Test Acc: 0.9717
--------------------------------------------------
100%|██████████| 938/938 [00:24<00:00, 37.84it/s]
100%|██████████| 157/157 [00:03<00:00, 43.77it/s]
Epoch 2/10:
Train Loss: 0.1194, Train Acc: 0.9625
Test Loss: 0.0757, Test Acc: 0.9759
--------------------------------------------------
100%|██████████| 938/938 [00:24<00:00, 38.06it/s]
100%|██████████| 157/157 [00:03<00:00, 42.73it/s]
Epoch 3/10:
Train Loss: 0.0951, Train Acc: 0.9698
Test Loss: 0.0706, Test Acc: 0.9794
--------------------------------------------------
100%|██████████| 938/938 [00:24<00:00, 38.27it/s]
100%|██████████| 157/157 [00:03<00:00, 44.30it/s]
Epoch 4/10:
Train Loss: 0.0772, Train Acc: 0.9751
Test Loss: 0.0611, Test Acc: 0.9810
--------------------------------------------------
100%|██████████| 938/938 [00:24<00:00, 38.18it/s]
100%|██████████| 157/157 [00:03<00:00, 43.31it/s]
Epoch 5/10:
Train Loss: 0.0674, Train Acc: 0.9781
Test Loss: 0.0633, Test Acc: 0.9799
--------------------------------------------------
100%|██████████| 938/938 [00:24<00:00, 37.86it/s]
100%|██████████| 157/157 [00:03<00:00, 43.28it/s]
Epoch 6/10:
Train Loss: 0.0596, Train Acc: 0.9810
Test Loss: 0.0561, Test Acc: 0.9822
--------------------------------------------------
100%|██████████| 938/938 [00:24<00:00, 37.56it/s]
100%|██████████| 157/157 [00:03<00:00, 42.88it/s]
  0%|          | 0/938 [00:00<?, ?it/s]Epoch 7/10:
Train Loss: 0.0537, Train Acc: 0.9829
Test Loss: 0.0604, Test Acc: 0.9817
--------------------------------------------------
100%|██████████| 938/938 [00:24<00:00, 38.81it/s]
100%|██████████| 157/157 [00:03<00:00, 44.04it/s]
  0%|          | 0/938 [00:00<?, ?it/s]Epoch 8/10:
Train Loss: 0.0490, Train Acc: 0.9840
Test Loss: 0.0544, Test Acc: 0.9823
--------------------------------------------------
100%|██████████| 938/938 [00:24<00:00, 38.97it/s]
100%|██████████| 157/157 [00:03<00:00, 43.94it/s]
  0%|          | 0/938 [00:00<?, ?it/s]Epoch 9/10:
Train Loss: 0.0458, Train Acc: 0.9846
Test Loss: 0.0622, Test Acc: 0.9820
--------------------------------------------------
100%|██████████| 938/938 [00:24<00:00, 39.05it/s]
100%|██████████| 157/157 [00:03<00:00, 43.75it/s]
Epoch 10/10:
Train Loss: 0.0408, Train Acc: 0.9867
Test Loss: 0.0590, Test Acc: 0.9820
--------------------------------------------------
3_layers_reg - Время обучения: 281.11 секунд
3_layers_reg - Итоговая точность на тестовом наборе: 0.9820
  0%|          | 0/938 [00:00<?, ?it/s]
Обучение модели 5_layers_reg
100%|██████████| 938/938 [00:27<00:00, 34.33it/s]
100%|██████████| 157/157 [00:03<00:00, 43.23it/s]
  0%|          | 0/938 [00:00<?, ?it/s]Epoch 1/10:
Train Loss: 0.2818, Train Acc: 0.9177
Test Loss: 0.1098, Test Acc: 0.9658
--------------------------------------------------
100%|██████████| 938/938 [00:26<00:00, 35.22it/s]
100%|██████████| 157/157 [00:03<00:00, 40.70it/s]
  0%|          | 0/938 [00:00<?, ?it/s]Epoch 2/10:
Train Loss: 0.1528, Train Acc: 0.9543
Test Loss: 0.0850, Test Acc: 0.9723
--------------------------------------------------
100%|██████████| 938/938 [00:27<00:00, 34.13it/s]
100%|██████████| 157/157 [00:03<00:00, 42.43it/s]
Epoch 3/10:
Train Loss: 0.1208, Train Acc: 0.9629
Test Loss: 0.0729, Test Acc: 0.9771
--------------------------------------------------
100%|██████████| 938/938 [00:26<00:00, 34.95it/s]
100%|██████████| 157/157 [00:03<00:00, 41.70it/s]
  0%|          | 0/938 [00:00<?, ?it/s]Epoch 4/10:
Train Loss: 0.1027, Train Acc: 0.9688
Test Loss: 0.0712, Test Acc: 0.9782
--------------------------------------------------
100%|██████████| 938/938 [00:27<00:00, 34.67it/s]
100%|██████████| 157/157 [00:03<00:00, 43.84it/s]
Epoch 5/10:
Train Loss: 0.0936, Train Acc: 0.9704
Test Loss: 0.0615, Test Acc: 0.9808
--------------------------------------------------
100%|██████████| 938/938 [00:26<00:00, 35.37it/s]
100%|██████████| 157/157 [00:03<00:00, 42.54it/s]
Epoch 6/10:
Train Loss: 0.0820, Train Acc: 0.9744
Test Loss: 0.0622, Test Acc: 0.9816
--------------------------------------------------
100%|██████████| 938/938 [00:27<00:00, 34.36it/s]
100%|██████████| 157/157 [00:03<00:00, 42.68it/s]
  0%|          | 0/938 [00:00<?, ?it/s]Epoch 7/10:
Train Loss: 0.0743, Train Acc: 0.9770
Test Loss: 0.0566, Test Acc: 0.9827
--------------------------------------------------
100%|██████████| 938/938 [00:27<00:00, 34.34it/s]
100%|██████████| 157/157 [00:03<00:00, 41.82it/s]
  0%|          | 0/938 [00:00<?, ?it/s]Epoch 8/10:
Train Loss: 0.0687, Train Acc: 0.9784
Test Loss: 0.0547, Test Acc: 0.9819
--------------------------------------------------
100%|██████████| 938/938 [00:26<00:00, 35.27it/s]
100%|██████████| 157/157 [00:03<00:00, 42.52it/s]
  0%|          | 0/938 [00:00<?, ?it/s]Epoch 9/10:
Train Loss: 0.0630, Train Acc: 0.9800
Test Loss: 0.0561, Test Acc: 0.9844
--------------------------------------------------
100%|██████████| 938/938 [00:26<00:00, 35.18it/s]
100%|██████████| 157/157 [00:03<00:00, 43.67it/s]
Epoch 10/10:
Train Loss: 0.0587, Train Acc: 0.9810
Test Loss: 0.0577, Test Acc: 0.9830
--------------------------------------------------
5_layers_reg - Время обучения: 306.67 секунд
5_layers_reg - Итоговая точность на тестовом наборе: 0.9830
  0%|          | 0/938 [00:00<?, ?it/s]
Обучение модели 7_layers_reg
100%|██████████| 938/938 [00:29<00:00, 32.25it/s]
100%|██████████| 157/157 [00:04<00:00, 38.62it/s]
Epoch 1/10:
Train Loss: 0.3464, Train Acc: 0.8973
Test Loss: 0.1190, Test Acc: 0.9649
--------------------------------------------------
100%|██████████| 938/938 [00:29<00:00, 32.11it/s]
100%|██████████| 157/157 [00:03<00:00, 42.42it/s]
Epoch 2/10:
Train Loss: 0.1844, Train Acc: 0.9452
Test Loss: 0.0917, Test Acc: 0.9700
--------------------------------------------------
100%|██████████| 938/938 [00:29<00:00, 31.62it/s]
100%|██████████| 157/157 [00:03<00:00, 40.98it/s]
  0%|          | 0/938 [00:00<?, ?it/s]Epoch 3/10:
Train Loss: 0.1522, Train Acc: 0.9557
Test Loss: 0.0801, Test Acc: 0.9750
--------------------------------------------------
100%|██████████| 938/938 [00:30<00:00, 31.19it/s]
100%|██████████| 157/157 [00:03<00:00, 41.43it/s]
Epoch 4/10:
Train Loss: 0.1282, Train Acc: 0.9629
Test Loss: 0.0827, Test Acc: 0.9754
--------------------------------------------------
100%|██████████| 938/938 [00:29<00:00, 32.25it/s]
100%|██████████| 157/157 [00:03<00:00, 43.66it/s]
Epoch 5/10:
Train Loss: 0.1166, Train Acc: 0.9663
Test Loss: 0.0687, Test Acc: 0.9791
--------------------------------------------------
100%|██████████| 938/938 [00:28<00:00, 32.89it/s]
100%|██████████| 157/157 [00:03<00:00, 42.72it/s]
Epoch 6/10:
Train Loss: 0.1039, Train Acc: 0.9693
Test Loss: 0.0622, Test Acc: 0.9816
--------------------------------------------------
100%|██████████| 938/938 [00:28<00:00, 33.01it/s]
100%|██████████| 157/157 [00:03<00:00, 41.70it/s]
  0%|          | 0/938 [00:00<?, ?it/s]Epoch 7/10:
Train Loss: 0.0922, Train Acc: 0.9725
Test Loss: 0.0639, Test Acc: 0.9803
--------------------------------------------------
100%|██████████| 938/938 [00:28<00:00, 32.82it/s]
100%|██████████| 157/157 [00:03<00:00, 41.31it/s]
  0%|          | 0/938 [00:00<?, ?it/s]Epoch 8/10:
Train Loss: 0.0886, Train Acc: 0.9747
Test Loss: 0.0598, Test Acc: 0.9822
--------------------------------------------------
100%|██████████| 938/938 [00:28<00:00, 33.19it/s]
100%|██████████| 157/157 [00:03<00:00, 42.54it/s]
  0%|          | 0/938 [00:00<?, ?it/s]Epoch 9/10:
Train Loss: 0.0774, Train Acc: 0.9766
Test Loss: 0.0618, Test Acc: 0.9808
--------------------------------------------------
100%|██████████| 938/938 [00:28<00:00, 32.93it/s]
100%|██████████| 157/157 [00:03<00:00, 43.27it/s]
Epoch 10/10:
Train Loss: 0.0742, Train Acc: 0.9776
Test Loss: 0.0653, Test Acc: 0.9819
--------------------------------------------------
7_layers_reg - Время обучения: 326.93 секунд
7_layers_reg - Итоговая точность на тестовом наборе: 0.9819

Сводный анализ

Базовые модели:
1_layer:
Итоговая точность train: 0.9274
Итоговая точность test: 0.9214
2_layers:
Итоговая точность train: 0.9940
Итоговая точность test: 0.9778
3_layers:
Итоговая точность train: 0.9929
Итоговая точность test: 0.9801
5_layers:
Итоговая точность train: 0.9907
Итоговая точность test: 0.9788
7_layers:
Итоговая точность train: 0.9895
Итоговая точность test: 0.9780

Модели с регуляризацией:
2_layers_reg:
Итоговая точность train: 0.9880
Итоговая точность test: 0.9789
3_layers_reg:
Итоговая точность train: 0.9867
Итоговая точность test: 0.9820
5_layers_reg:
Итоговая точность train: 0.9810
Итоговая точность test: 0.9830
7_layers_reg:
Итоговая точность train: 0.9776
Итоговая точность test: 0.9819

Лучшая базовая модель: 3_layers с точностью на тестовом наборе: 0.9801
Лучшая модель с регуляризацией: 5_layers_reg с точностью на тестовом наборе: 0.9830
