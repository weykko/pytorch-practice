C:\1studying\summer-practice\pytorch-practice\.venv\Scripts\python.exe "C:\1studying\summer-practice\pytorch-practice\homework 3\homework_width_experiments.py"
2.1: Сравнение моделей с разной шириной слоев

Обучение модели narrow
100%|██████████| 938/938 [00:25<00:00, 37.44it/s]
100%|██████████| 157/157 [00:03<00:00, 44.98it/s]
Epoch 1/10:
Train Loss: 0.3944, Train Acc: 0.8794
Test Loss: 0.2069, Test Acc: 0.9389
--------------------------------------------------
100%|██████████| 938/938 [00:23<00:00, 40.50it/s]
100%|██████████| 157/157 [00:03<00:00, 45.89it/s]
  0%|          | 0/938 [00:00<?, ?it/s]Epoch 2/10:
Train Loss: 0.1630, Train Acc: 0.9515
Test Loss: 0.1429, Test Acc: 0.9562
--------------------------------------------------
100%|██████████| 938/938 [00:22<00:00, 41.06it/s]
100%|██████████| 157/157 [00:03<00:00, 44.48it/s]
Epoch 3/10:
Train Loss: 0.1168, Train Acc: 0.9644
Test Loss: 0.1126, Test Acc: 0.9656
--------------------------------------------------
100%|██████████| 938/938 [00:23<00:00, 40.19it/s]
100%|██████████| 157/157 [00:03<00:00, 44.18it/s]
Epoch 4/10:
Train Loss: 0.0934, Train Acc: 0.9706
Test Loss: 0.1016, Test Acc: 0.9672
--------------------------------------------------
100%|██████████| 938/938 [00:22<00:00, 41.60it/s]
100%|██████████| 157/157 [00:03<00:00, 45.87it/s]
  0%|          | 0/938 [00:00<?, ?it/s]Epoch 5/10:
Train Loss: 0.0797, Train Acc: 0.9755
Test Loss: 0.0929, Test Acc: 0.9731
--------------------------------------------------
100%|██████████| 938/938 [00:21<00:00, 42.79it/s]
100%|██████████| 157/157 [00:03<00:00, 46.75it/s]
Epoch 6/10:
Train Loss: 0.0686, Train Acc: 0.9778
Test Loss: 0.1069, Test Acc: 0.9662
--------------------------------------------------
100%|██████████| 938/938 [00:23<00:00, 40.65it/s]
100%|██████████| 157/157 [00:03<00:00, 46.21it/s]
  0%|          | 0/938 [00:00<?, ?it/s]Epoch 7/10:
Train Loss: 0.0595, Train Acc: 0.9809
Test Loss: 0.1089, Test Acc: 0.9679
--------------------------------------------------
100%|██████████| 938/938 [00:22<00:00, 41.28it/s]
100%|██████████| 157/157 [00:03<00:00, 44.09it/s]
  0%|          | 0/938 [00:00<?, ?it/s]Epoch 8/10:
Train Loss: 0.0514, Train Acc: 0.9828
Test Loss: 0.0937, Test Acc: 0.9741
--------------------------------------------------
100%|██████████| 938/938 [00:22<00:00, 40.99it/s]
100%|██████████| 157/157 [00:03<00:00, 44.20it/s]
  0%|          | 0/938 [00:00<?, ?it/s]Epoch 9/10:
Train Loss: 0.0464, Train Acc: 0.9850
Test Loss: 0.0955, Test Acc: 0.9732
--------------------------------------------------
100%|██████████| 938/938 [00:22<00:00, 41.51it/s]
100%|██████████| 157/157 [00:03<00:00, 44.21it/s]
Epoch 10/10:
Train Loss: 0.0399, Train Acc: 0.9869
Test Loss: 0.1014, Test Acc: 0.9726
--------------------------------------------------

Обучение модели medium
100%|██████████| 938/938 [00:23<00:00, 39.73it/s]
100%|██████████| 157/157 [00:03<00:00, 44.45it/s]
  0%|          | 0/938 [00:00<?, ?it/s]Epoch 1/10:
Train Loss: 0.2580, Train Acc: 0.9210
Test Loss: 0.1257, Test Acc: 0.9613
--------------------------------------------------
100%|██████████| 938/938 [00:23<00:00, 39.77it/s]
100%|██████████| 157/157 [00:03<00:00, 44.77it/s]
  0%|          | 0/938 [00:00<?, ?it/s]Epoch 2/10:
Train Loss: 0.1028, Train Acc: 0.9681
Test Loss: 0.1043, Test Acc: 0.9680
--------------------------------------------------
100%|██████████| 938/938 [00:23<00:00, 39.47it/s]
100%|██████████| 157/157 [00:03<00:00, 45.20it/s]
  0%|          | 0/938 [00:00<?, ?it/s]Epoch 3/10:
Train Loss: 0.0693, Train Acc: 0.9788
Test Loss: 0.0883, Test Acc: 0.9734
--------------------------------------------------
100%|██████████| 938/938 [00:23<00:00, 40.32it/s]
100%|██████████| 157/157 [00:03<00:00, 45.07it/s]
Epoch 4/10:
Train Loss: 0.0573, Train Acc: 0.9816
Test Loss: 0.0947, Test Acc: 0.9718
--------------------------------------------------
100%|██████████| 938/938 [00:24<00:00, 38.74it/s]
100%|██████████| 157/157 [00:03<00:00, 44.14it/s]
  0%|          | 0/938 [00:00<?, ?it/s]Epoch 5/10:
Train Loss: 0.0438, Train Acc: 0.9858
Test Loss: 0.0904, Test Acc: 0.9745
--------------------------------------------------
100%|██████████| 938/938 [00:23<00:00, 39.50it/s]
100%|██████████| 157/157 [00:03<00:00, 44.71it/s]
Epoch 6/10:
Train Loss: 0.0388, Train Acc: 0.9869
Test Loss: 0.0823, Test Acc: 0.9772
--------------------------------------------------
100%|██████████| 938/938 [00:23<00:00, 40.43it/s]
100%|██████████| 157/157 [00:03<00:00, 46.03it/s]
Epoch 7/10:
Train Loss: 0.0319, Train Acc: 0.9894
Test Loss: 0.0748, Test Acc: 0.9807
--------------------------------------------------
100%|██████████| 938/938 [00:23<00:00, 40.13it/s]
100%|██████████| 157/157 [00:03<00:00, 44.09it/s]
Epoch 8/10:
Train Loss: 0.0261, Train Acc: 0.9915
Test Loss: 0.0948, Test Acc: 0.9740
--------------------------------------------------
100%|██████████| 938/938 [00:24<00:00, 39.02it/s]
100%|██████████| 157/157 [00:03<00:00, 43.39it/s]
  0%|          | 0/938 [00:00<?, ?it/s]Epoch 9/10:
Train Loss: 0.0258, Train Acc: 0.9916
Test Loss: 0.0942, Test Acc: 0.9766
--------------------------------------------------
100%|██████████| 938/938 [00:23<00:00, 39.48it/s]
100%|██████████| 157/157 [00:03<00:00, 45.21it/s]
Epoch 10/10:
Train Loss: 0.0213, Train Acc: 0.9935
Test Loss: 0.1051, Test Acc: 0.9738
--------------------------------------------------

Обучение модели wide
100%|██████████| 938/938 [00:29<00:00, 31.79it/s]
100%|██████████| 157/157 [00:03<00:00, 40.63it/s]
  0%|          | 0/938 [00:00<?, ?it/s]Epoch 1/10:
Train Loss: 0.2080, Train Acc: 0.9352
Test Loss: 0.1310, Test Acc: 0.9593
--------------------------------------------------
100%|██████████| 938/938 [00:27<00:00, 33.77it/s]
100%|██████████| 157/157 [00:03<00:00, 42.34it/s]
  0%|          | 0/938 [00:00<?, ?it/s]Epoch 2/10:
Train Loss: 0.0956, Train Acc: 0.9716
Test Loss: 0.0865, Test Acc: 0.9716
--------------------------------------------------
100%|██████████| 938/938 [00:31<00:00, 30.22it/s]
100%|██████████| 157/157 [00:03<00:00, 43.71it/s]
Epoch 3/10:
Train Loss: 0.0682, Train Acc: 0.9790
Test Loss: 0.0865, Test Acc: 0.9751
--------------------------------------------------
100%|██████████| 938/938 [00:31<00:00, 30.20it/s]
100%|██████████| 157/157 [00:03<00:00, 39.78it/s]
  0%|          | 0/938 [00:00<?, ?it/s]Epoch 4/10:
Train Loss: 0.0565, Train Acc: 0.9828
Test Loss: 0.0943, Test Acc: 0.9719
--------------------------------------------------
100%|██████████| 938/938 [00:32<00:00, 28.84it/s]
100%|██████████| 157/157 [00:03<00:00, 43.68it/s]
Epoch 5/10:
Train Loss: 0.0447, Train Acc: 0.9860
Test Loss: 0.0852, Test Acc: 0.9756
--------------------------------------------------
100%|██████████| 938/938 [00:23<00:00, 40.00it/s]
100%|██████████| 157/157 [00:03<00:00, 46.52it/s]
Epoch 6/10:
Train Loss: 0.0349, Train Acc: 0.9895
Test Loss: 0.0820, Test Acc: 0.9798
--------------------------------------------------
100%|██████████| 938/938 [00:25<00:00, 36.24it/s]
100%|██████████| 157/157 [00:03<00:00, 44.95it/s]
Epoch 7/10:
Train Loss: 0.0339, Train Acc: 0.9902
Test Loss: 0.0814, Test Acc: 0.9796
--------------------------------------------------
100%|██████████| 938/938 [00:27<00:00, 34.18it/s]
100%|██████████| 157/157 [00:03<00:00, 39.73it/s]
  0%|          | 0/938 [00:00<?, ?it/s]Epoch 8/10:
Train Loss: 0.0276, Train Acc: 0.9910
Test Loss: 0.0864, Test Acc: 0.9821
--------------------------------------------------
100%|██████████| 938/938 [00:27<00:00, 34.21it/s]
100%|██████████| 157/157 [00:03<00:00, 43.35it/s]
  0%|          | 0/938 [00:00<?, ?it/s]Epoch 9/10:
Train Loss: 0.0278, Train Acc: 0.9918
Test Loss: 0.0856, Test Acc: 0.9803
--------------------------------------------------
100%|██████████| 938/938 [00:26<00:00, 35.35it/s]
100%|██████████| 157/157 [00:03<00:00, 43.37it/s]
Epoch 10/10:
Train Loss: 0.0259, Train Acc: 0.9920
Test Loss: 0.0867, Test Acc: 0.9795
--------------------------------------------------

Обучение модели very_wide
100%|██████████| 938/938 [00:34<00:00, 27.40it/s]
100%|██████████| 157/157 [00:03<00:00, 40.54it/s]
  0%|          | 0/938 [00:00<?, ?it/s]Epoch 1/10:
Train Loss: 0.2101, Train Acc: 0.9366
Test Loss: 0.1863, Test Acc: 0.9424
--------------------------------------------------
100%|██████████| 938/938 [00:34<00:00, 27.07it/s]
100%|██████████| 157/157 [00:03<00:00, 42.33it/s]
Epoch 2/10:
Train Loss: 0.1031, Train Acc: 0.9690
Test Loss: 0.1065, Test Acc: 0.9687
--------------------------------------------------
100%|██████████| 938/938 [00:30<00:00, 30.31it/s]
100%|██████████| 157/157 [00:03<00:00, 43.73it/s]
  0%|          | 0/938 [00:00<?, ?it/s]Epoch 3/10:
Train Loss: 0.0730, Train Acc: 0.9779
Test Loss: 0.0780, Test Acc: 0.9757
--------------------------------------------------
100%|██████████| 938/938 [00:34<00:00, 26.90it/s]
100%|██████████| 157/157 [00:03<00:00, 41.66it/s]
Epoch 4/10:
Train Loss: 0.0559, Train Acc: 0.9834
Test Loss: 0.0832, Test Acc: 0.9777
--------------------------------------------------
100%|██████████| 938/938 [00:34<00:00, 27.02it/s]
100%|██████████| 157/157 [00:03<00:00, 40.61it/s]
Epoch 5/10:
Train Loss: 0.0466, Train Acc: 0.9861
Test Loss: 0.0934, Test Acc: 0.9730
--------------------------------------------------
100%|██████████| 938/938 [00:36<00:00, 25.38it/s]
100%|██████████| 157/157 [00:03<00:00, 39.33it/s]
  0%|          | 0/938 [00:00<?, ?it/s]Epoch 6/10:
Train Loss: 0.0405, Train Acc: 0.9877
Test Loss: 0.0840, Test Acc: 0.9798
--------------------------------------------------
100%|██████████| 938/938 [00:35<00:00, 26.18it/s]
100%|██████████| 157/157 [00:04<00:00, 37.22it/s]
  0%|          | 0/938 [00:00<?, ?it/s]Epoch 7/10:
Train Loss: 0.0400, Train Acc: 0.9885
Test Loss: 0.0732, Test Acc: 0.9819
--------------------------------------------------
100%|██████████| 938/938 [00:37<00:00, 25.01it/s]
100%|██████████| 157/157 [00:04<00:00, 34.46it/s]
Epoch 8/10:
Train Loss: 0.0278, Train Acc: 0.9922
Test Loss: 0.0833, Test Acc: 0.9809
--------------------------------------------------
100%|██████████| 938/938 [00:35<00:00, 26.31it/s]
100%|██████████| 157/157 [00:03<00:00, 43.04it/s]
  0%|          | 0/938 [00:00<?, ?it/s]Epoch 9/10:
Train Loss: 0.0289, Train Acc: 0.9916
Test Loss: 0.0895, Test Acc: 0.9798
--------------------------------------------------
100%|██████████| 938/938 [00:34<00:00, 27.22it/s]
100%|██████████| 157/157 [00:03<00:00, 41.19it/s]
Epoch 10/10:
Train Loss: 0.0273, Train Acc: 0.9923
Test Loss: 0.0964, Test Acc: 0.9778
--------------------------------------------------

Результаты экспериментов с шириной:
narrow: Параметры: 53018, Время обучения: 265.00 с, Итоговая точность test: 0.9726
medium: Параметры: 242762, Время обучения: 271.69 с, Итоговая точность test: 0.9738
wide: Параметры: 1462538, Время обучения: 319.41 с, Итоговая точность test: 0.9795
very_wide: Параметры: 4235786, Время обучения: 388.86 с, Итоговая точность test: 0.9778

C:\1studying\summer-practice\pytorch-practice\.venv\Scripts\python.exe "C:\1studying\summer-practice\pytorch-practice\homework 3\homework_width_experiments.py"

2.2: Оптимизация архитектуры с использованием сетчатого поиска

Обучение модели contracting_512_256_128...
100%|██████████| 938/938 [00:26<00:00, 34.81it/s]
100%|██████████| 157/157 [00:03<00:00, 43.90it/s]
Epoch 1/10:
Train Loss: 0.2242, Train Acc: 0.9314
Test Loss: 0.1335, Test Acc: 0.9582
--------------------------------------------------
100%|██████████| 938/938 [00:25<00:00, 36.22it/s]
100%|██████████| 157/157 [00:03<00:00, 43.63it/s]
  0%|          | 0/938 [00:00<?, ?it/s]Epoch 2/10:
Train Loss: 0.0958, Train Acc: 0.9713
Test Loss: 0.0908, Test Acc: 0.9727
--------------------------------------------------
100%|██████████| 938/938 [00:25<00:00, 36.93it/s]
100%|██████████| 157/157 [00:03<00:00, 43.84it/s]
Epoch 3/10:
Train Loss: 0.0682, Train Acc: 0.9787
Test Loss: 0.0972, Test Acc: 0.9704
--------------------------------------------------
100%|██████████| 938/938 [00:26<00:00, 35.42it/s]
100%|██████████| 157/157 [00:03<00:00, 43.41it/s]
Epoch 4/10:
Train Loss: 0.0523, Train Acc: 0.9831
Test Loss: 0.0898, Test Acc: 0.9742
--------------------------------------------------
100%|██████████| 938/938 [00:26<00:00, 35.39it/s]
100%|██████████| 157/157 [00:03<00:00, 42.88it/s]
  0%|          | 0/938 [00:00<?, ?it/s]Epoch 5/10:
Train Loss: 0.0414, Train Acc: 0.9866
Test Loss: 0.0711, Test Acc: 0.9787
--------------------------------------------------
100%|██████████| 938/938 [00:26<00:00, 35.85it/s]
100%|██████████| 157/157 [00:03<00:00, 43.14it/s]
Epoch 6/10:
Train Loss: 0.0374, Train Acc: 0.9883
Test Loss: 0.1134, Test Acc: 0.9714
--------------------------------------------------
100%|██████████| 938/938 [00:26<00:00, 35.85it/s]
100%|██████████| 157/157 [00:03<00:00, 43.14it/s]
Epoch 7/10:
Train Loss: 0.0313, Train Acc: 0.9904
Test Loss: 0.0896, Test Acc: 0.9785
--------------------------------------------------
100%|██████████| 938/938 [00:25<00:00, 36.29it/s]
100%|██████████| 157/157 [00:03<00:00, 42.03it/s]
Epoch 8/10:
Train Loss: 0.0283, Train Acc: 0.9914
Test Loss: 0.0859, Test Acc: 0.9798
--------------------------------------------------
100%|██████████| 938/938 [00:26<00:00, 35.45it/s]
100%|██████████| 157/157 [00:03<00:00, 43.72it/s]
  0%|          | 0/938 [00:00<?, ?it/s]Epoch 9/10:
Train Loss: 0.0247, Train Acc: 0.9919
Test Loss: 0.0863, Test Acc: 0.9816
--------------------------------------------------
100%|██████████| 938/938 [00:26<00:00, 35.86it/s]
100%|██████████| 157/157 [00:03<00:00, 44.34it/s]
Epoch 10/10:
Train Loss: 0.0213, Train Acc: 0.9931
Test Loss: 0.0806, Test Acc: 0.9819
--------------------------------------------------

Обучение модели contracting_1024_512_256...
100%|██████████| 938/938 [00:29<00:00, 32.04it/s]
100%|██████████| 157/157 [00:03<00:00, 43.94it/s]
Epoch 1/10:
Train Loss: 0.2090, Train Acc: 0.9363
Test Loss: 0.1117, Test Acc: 0.9659
--------------------------------------------------
100%|██████████| 938/938 [00:26<00:00, 35.59it/s]
100%|██████████| 157/157 [00:03<00:00, 43.39it/s]
  0%|          | 0/938 [00:00<?, ?it/s]Epoch 2/10:
Train Loss: 0.0950, Train Acc: 0.9718
Test Loss: 0.0969, Test Acc: 0.9704
--------------------------------------------------
100%|██████████| 938/938 [00:27<00:00, 33.57it/s]
100%|██████████| 157/157 [00:03<00:00, 42.54it/s]
  0%|          | 0/938 [00:00<?, ?it/s]Epoch 3/10:
Train Loss: 0.0659, Train Acc: 0.9798
Test Loss: 0.0958, Test Acc: 0.9715
--------------------------------------------------
100%|██████████| 938/938 [00:27<00:00, 34.66it/s]
100%|██████████| 157/157 [00:03<00:00, 43.98it/s]
  0%|          | 0/938 [00:00<?, ?it/s]Epoch 4/10:
Train Loss: 0.0541, Train Acc: 0.9838
Test Loss: 0.0867, Test Acc: 0.9773
--------------------------------------------------
100%|██████████| 938/938 [00:27<00:00, 34.38it/s]
100%|██████████| 157/157 [00:03<00:00, 45.05it/s]
  0%|          | 0/938 [00:00<?, ?it/s]Epoch 5/10:
Train Loss: 0.0434, Train Acc: 0.9865
Test Loss: 0.0878, Test Acc: 0.9778
--------------------------------------------------
100%|██████████| 938/938 [00:22<00:00, 41.01it/s]
100%|██████████| 157/157 [00:03<00:00, 44.76it/s]
  0%|          | 0/938 [00:00<?, ?it/s]Epoch 6/10:
Train Loss: 0.0382, Train Acc: 0.9882
Test Loss: 0.0848, Test Acc: 0.9795
--------------------------------------------------
100%|██████████| 938/938 [00:25<00:00, 36.96it/s]
100%|██████████| 157/157 [00:03<00:00, 43.15it/s]
  0%|          | 0/938 [00:00<?, ?it/s]Epoch 7/10:
Train Loss: 0.0331, Train Acc: 0.9899
Test Loss: 0.0711, Test Acc: 0.9809
--------------------------------------------------
100%|██████████| 938/938 [00:27<00:00, 34.46it/s]
100%|██████████| 157/157 [00:03<00:00, 42.45it/s]
Epoch 8/10:
Train Loss: 0.0302, Train Acc: 0.9911
Test Loss: 0.0805, Test Acc: 0.9794
--------------------------------------------------
100%|██████████| 938/938 [00:28<00:00, 32.95it/s]
100%|██████████| 157/157 [00:04<00:00, 38.76it/s]
  0%|          | 0/938 [00:00<?, ?it/s]Epoch 9/10:
Train Loss: 0.0238, Train Acc: 0.9926
Test Loss: 0.0939, Test Acc: 0.9786
--------------------------------------------------
100%|██████████| 938/938 [00:28<00:00, 32.44it/s]
100%|██████████| 157/157 [00:04<00:00, 37.17it/s]
  0%|          | 0/938 [00:00<?, ?it/s]Epoch 10/10:
Train Loss: 0.0283, Train Acc: 0.9915
Test Loss: 0.0790, Test Acc: 0.9809
--------------------------------------------------

Обучение модели expanding_128_256_512...
100%|██████████| 938/938 [00:26<00:00, 36.05it/s]
100%|██████████| 157/157 [00:03<00:00, 42.10it/s]
Epoch 1/10:
Train Loss: 0.2402, Train Acc: 0.9264
Test Loss: 0.1155, Test Acc: 0.9620
--------------------------------------------------
100%|██████████| 938/938 [00:23<00:00, 39.82it/s]
100%|██████████| 157/157 [00:03<00:00, 43.28it/s]
Epoch 2/10:
Train Loss: 0.1045, Train Acc: 0.9673
Test Loss: 0.1023, Test Acc: 0.9696
--------------------------------------------------
100%|██████████| 938/938 [00:25<00:00, 37.01it/s]
100%|██████████| 157/157 [00:03<00:00, 42.69it/s]
  0%|          | 0/938 [00:00<?, ?it/s]Epoch 3/10:
Train Loss: 0.0764, Train Acc: 0.9764
Test Loss: 0.1059, Test Acc: 0.9681
--------------------------------------------------
100%|██████████| 938/938 [00:24<00:00, 37.79it/s]
100%|██████████| 157/157 [00:03<00:00, 43.90it/s]
  0%|          | 0/938 [00:00<?, ?it/s]Epoch 4/10:
Train Loss: 0.0615, Train Acc: 0.9812
Test Loss: 0.1001, Test Acc: 0.9684
--------------------------------------------------
100%|██████████| 938/938 [00:25<00:00, 37.12it/s]
100%|██████████| 157/157 [00:03<00:00, 43.97it/s]
  0%|          | 0/938 [00:00<?, ?it/s]Epoch 5/10:
Train Loss: 0.0511, Train Acc: 0.9839
Test Loss: 0.1103, Test Acc: 0.9672
--------------------------------------------------
100%|██████████| 938/938 [00:26<00:00, 35.83it/s]
100%|██████████| 157/157 [00:04<00:00, 37.85it/s]
Epoch 6/10:
Train Loss: 0.0428, Train Acc: 0.9863
Test Loss: 0.0871, Test Acc: 0.9749
--------------------------------------------------
100%|██████████| 938/938 [00:24<00:00, 38.99it/s]
100%|██████████| 157/157 [00:03<00:00, 42.68it/s]
  0%|          | 0/938 [00:00<?, ?it/s]Epoch 7/10:
Train Loss: 0.0401, Train Acc: 0.9870
Test Loss: 0.0936, Test Acc: 0.9744
--------------------------------------------------
